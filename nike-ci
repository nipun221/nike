pipeline {
    agent any 
    tools { nodejs 'Node_25' }
    triggers { pollSCM('H/2 * * * *') }
    options { timestamps() }
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Install Dependencies') {
            steps {
                sh 'npm ci || npm install'
            }
        }

        stage('Build and Archive') {
            steps {
                sh 'npm run build'
                archiveArtifacts artifacts: 'dist/**', fingerprint: true
            }
        }

        stage('Trigger Downstream Job') {
            steps {
                build job: 'nike-deployment', wait: false
            }
        }
    }
}